/*! KeyTable 2.2.1
 * ©2009-2016 SpryMedia Ltd - datatables.net/license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var u=n.fn.dataTable,f=function(t,i){if(!u.versionCheck||!u.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=n.extend(!0,{},u.defaults.keyTable,f.defaults,i);this.s={dt:new u.Api(t),enable:!0,focusDraw:!1,waitingForDraw:!1,lastFocus:null};this.dom={};var r=this.s.dt.settings()[0],e=r.keytable;if(e)return e;r.keytable=this;this._constructor()};n.extend(f.prototype,{blur:function(){this._blur()},enable:function(n){this.s.enable=n},focus:function(n,t){this._focus(this.s.dt.cell(n,t))},focused:function(n){var i=this.s.lastFocus,t;return i?(t=this.s.lastFocus.cell.index(),n.row===t.row&&n.column===t.column):!1},_constructor:function(){var u;this._tabInput();var r=this,t=this.s.dt,f=n(t.table().node());f.css("position")==="static"&&f.css("position","relative");n(t.table().body()).on("click.keyTable","th, td",function(n){if(r.s.enable!==!1){var i=t.cell(this);i.any()&&r._focus(i,null,!1,n)}});n(i).on("keydown.keyTable",function(n){r._key(n)});if(this.c.blurable)n(i).on("mousedown.keyTable",function(i){(n(i.target).parents(".dataTables_filter").length&&r._blur(),n(i.target).parents().filter(t.table().container()).length)||n(i.target).parents("div.DTE").length||n(i.target).parents("div.editor-datetime").length||n(i.target).parents().filter(".DTFC_Cloned").length||r._blur()});if(this.c.editor)t.on("key.keyTable",function(n,t,i,u,f){r._editor(i,f)});if(t.settings()[0].oFeatures.bStateSave)t.on("stateSaveParams.keyTable",function(n,t,i){i.keyTable=r.s.lastFocus?r.s.lastFocus.cell.index():null});t.on("draw.keyTable",function(u){var f;if(!r.s.focusDraw&&(f=r.s.lastFocus,f&&f.node&&n(f.node).closest("body")===i.body)){var s=r.s.lastFocus.relative,e=t.page.info(),o=s.row+e.start;if(e.recordsDisplay===0)return;o>=e.recordsDisplay&&(o=e.recordsDisplay-1);r._focus(o,s.column,!0,u)}});t.on("destroy.keyTable",function(){t.off(".keyTable");n(t.table().body()).off("click.keyTable","th, td");n(i.body).off("keydown.keyTable").off("click.keyTable")});if(u=t.state.loaded(),u&&u.keyTable)t.one("init",function(){var n=t.cell(u.keyTable);n.any()&&n.focus()});else this.c.focus&&t.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var t=this.s.lastFocus.cell;n(t.node()).removeClass(this.c.className);this.s.lastFocus=null;this._updateFixedColumns(t.index().column);this._emitEvent("key-blur",[this.s.dt,t])}},_columns:function(){var n=this.s.dt,i=n.columns(this.c.columns).indexes(),t=[];return n.columns(":visible").every(function(n){i.indexOf(n)!==-1&&t.push(n)}),t},_editor:function(t,i){var f=this,u=this.s.dt,r=this.c.editor;t!==16&&(i.stopPropagation(),t===13&&i.preventDefault(),r.one("open.keyTable",function(){r.off("cancelOpen.keyTable");n("div.DTE input, div.DTE textarea").select();u.keys.enable(f.c.editorKeys);u.one("key-blur.editor",function(){r.displayed()&&r.submit()});r.one("close",function(){u.keys.enable(!0);u.off("key-blur.editor")})}).one("cancelOpen.keyTable",function(){r.off("open.keyTable")}).inline(this.s.lastFocus.cell.index()))},_emitEvent:function(t,i){this.s.dt.iterator("table",function(r){n(r.nTable).triggerHandler(t,i)})},_focus:function(u,f,e,o){var a=this,h=this.s.dt,s=h.page.info(),w=this.s.lastFocus,v,c,l,y,p;if(o||(o=null),this.s.enable){if(typeof u!="number"&&(v=u.index(),f=v.column,u=h.rows({filter:"applied",order:"applied"}).indexes().indexOf(v.row),s.serverSide&&(u+=s.start)),s.length!==-1&&(u<s.start||u>=s.start+s.length)){this.s.focusDraw=!0;this.s.waitingForDraw=!0;h.one("draw",function(){a.s.focusDraw=!1;a.s.waitingForDraw=!1;a._focus(u,f,r,o)}).page(Math.floor(u/s.length)).draw(!1);return}if(n.inArray(f,this._columns())!==-1){if(s.serverSide&&(u-=s.start),c=h.cell(":eq("+u+")",f,{search:"applied"}),w){if(w.node===c.node())return;this._blur()}l=n(c.node());l.addClass(this.c.className);this._updateFixedColumns(f);(e===r||e===!0)&&(this._scroll(n(t),n(i.body),l,"offset"),y=h.table().body().parentNode,y!==h.table().header().parentNode&&(p=n(y.parentNode),this._scroll(p,p,l,"position")));this.s.lastFocus={cell:c,node:c.node(),relative:{row:h.rows({page:"current"}).indexes().indexOf(c.index().row),column:c.index().column}};this._emitEvent("key-focus",[this.s.dt,c,o||null]);h.state.save()}}},_key:function(t){var r,i,e,s,u,f,o;if(this.s.waitingForDraw){t.preventDefault();return}if((r=this.s.enable,i=r===!0||r==="navigation-only",r)&&t.keyCode!==0&&!t.ctrlKey&&!t.metaKey&&!t.altKey&&(e=this.s.lastFocus,e)&&(s=this,u=this.s.dt,!this.c.keys||n.inArray(t.keyCode,this.c.keys)!==-1))switch(t.keyCode){case 9:this._shift(t,t.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&r===!0&&this._blur();break;case 33:case 34:i&&(t.preventDefault(),u.page(t.keyCode===33?"previous":"next").draw(!1));break;case 35:case 36:i&&(t.preventDefault(),f=u.cells({page:"current"}).indexes(),o=this._columns(),this._focus(u.cell(f[t.keyCode===35?f.length-1:o[0]]),null,!0,t));break;case 37:i&&this._shift(t,"left");break;case 38:i&&this._shift(t,"up");break;case 39:i&&this._shift(t,"right");break;case 40:i&&this._shift(t,"down");break;default:r===!0&&this._emitEvent("key",[u,t.keyCode,this.s.lastFocus.cell,t])}},_scroll:function(n,t,i,r){var u=i[r](),f=i.outerHeight(),e=i.outerWidth(),h=t.scrollTop(),c=t.scrollLeft(),o=n.height(),s=n.width();u.top<h&&t.scrollTop(u.top);u.left<c&&t.scrollLeft(u.left);u.top+f>h+o&&f<o&&t.scrollTop(u.top+f-o);u.left+e>c+s&&e<s&&t.scrollLeft(u.left+e-s)},_shift:function(t,i,r){var v=this,s=this.s.dt,h=s.page.info(),a=h.recordsDisplay,c=this.s.lastFocus.cell,u=this._columns(),l;if(c){l=s.rows({filter:"applied",order:"applied"}).indexes().indexOf(c.index().row);h.serverSide&&(l+=h.start);var o=s.columns(u).indexes().indexOf(c.index().column),f=l,e=u[o];i==="right"?o>=u.length-1?(f++,e=u[0]):e=u[o+1]:i==="left"?o===0?(f--,e=u[u.length-1]):e=u[o-1]:i==="up"?f--:i==="down"&&f++;f>=0&&f<a&&n.inArray(e,u)!==-1?(t.preventDefault(),this._focus(f,e,!0,t)):r&&this.c.blurable?this._blur():t.preventDefault()}},_tabInput:function(){var u=this,t=this.s.dt,i=this.c.tabIndex!==null?this.c.tabIndex:t.settings()[0].iTabIndex,r;if(i!=-1){r=n('<div><input type="text" tabindex="'+i+'"/><\/div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(t.table().node());r.children().on("focus",function(n){t.cell(":eq(0)",{page:"current"}).any()&&u._focus(t.cell(":eq(0)","0:visible",{page:"current"}),null,!0,n)})}},_updateFixedColumns:function(n){var i=this.s.dt,t=i.settings()[0],r,u;t._oFixedColumns&&(r=t._oFixedColumns.s.iLeftColumns,u=t.aoColumns.length-t._oFixedColumns.s.iRightColumns,(n<r||n>=u)&&i.fixedColumns().update())}});f.defaults={blurable:!0,className:"focus",columns:"",editor:null,editorKeys:"navigation-only",focus:null,keys:null,tabIndex:null};f.version="2.2.1";n.fn.dataTable.KeyTable=f;n.fn.DataTable.KeyTable=f;u.Api.register("cell.blur()",function(){return this.iterator("table",function(n){n.keytable&&n.keytable.blur()})});u.Api.register("cell().focus()",function(){return this.iterator("cell",function(n,t,i){n.keytable&&n.keytable.focus(t,i)})});u.Api.register("keys.disable()",function(){return this.iterator("table",function(n){n.keytable&&n.keytable.enable(!1)})});u.Api.register("keys.enable()",function(n){return this.iterator("table",function(t){t.keytable&&t.keytable.enable(n===r?!0:n)})});u.ext.selector.cell.push(function(n,t,i){var f=t.focused,e=n.keytable,o=[],u,s;if(!e||f===r)return i;for(u=0,s=i.length;u<s;u++)(f===!0&&e.focused(i[u])||f===!1&&!e.focused(i[u]))&&o.push(i[u]);return o});n(i).on("preInit.dt.dtk",function(t,i){var r,e,o;t.namespace==="dt"&&(r=i.oInit.keys,e=u.defaults.keys,(r||e)&&(o=n.extend({},e,r),r!==!1&&new f(i,o)))});return f});
//# sourceMappingURL=dataTables.keyTable.min.js.map

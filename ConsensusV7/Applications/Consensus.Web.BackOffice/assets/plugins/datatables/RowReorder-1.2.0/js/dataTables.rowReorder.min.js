/*! RowReorder 1.2.0
 * 2015-2016 SpryMedia Ltd - datatables.net/license
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return n(t,window,document)}):typeof exports=="object"?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),n(i,t,t.document)}:n(jQuery,window,document)})(function(n,t,i,r){"use strict";var f=n.fn.dataTable,u=function(t,i){if(!f.versionCheck||!f.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=n.extend(!0,{},f.defaults.rowReorder,u.defaults,i);this.s={bodyTop:null,dt:new f.Api(t),getDataFn:f.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:f.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0};this.dom={clone:null,dtScroll:n("div.dataTables_scrollBody",this.s.dt.table().container())};var r=this.s.dt.settings()[0],e=r.rowreorder;if(e)return e;r.rowreorder=this;this._constructor()},e;n.extend(u.prototype,{_constructor:function(){var i=this,t=this.s.dt,r=n(t.table().node());r.css("position")==="static"&&r.css("position","relative");n(t.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(r){if(i.c.enabled){var u=n(this).closest("tr");if(t.row(u).any())return i._mouseDown(r,u),!1}});t.on("destroy.rowReorder",function(){n(t.table().container()).off(".rowReorder");t.off(".rowReorder")})},_cachePositions:function(){var i=this.s.dt,u=n(i.table().node()).find("thead").outerHeight(),f=n.unique(i.rows({page:"current"}).nodes().toArray()),r=n.map(f,function(t){return n(t).position().top-u}),e=n.map(r,function(t,u){return r.length<u-1?(t+r[u+1])/2:(t+t+n(i.row(":last-child").node()).outerHeight())/2});this.s.middles=e;this.s.bodyTop=n(i.table().body()).offset().top;this.s.windowHeight=n(t).height()},_clone:function(t){var r=this.s.dt,i=n(r.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(t.clone(!1)),u=t.outerWidth(),f=t.outerHeight(),e=t.children().map(function(){return n(this).width()});i.width(u).height(f).find("tr").children().each(function(n){this.style.width=e[n]+"px"});i.appendTo("body");this.dom.clone=i},_clonePosition:function(n){var t=this.s.start,u=this._eventToPage(n,"Y")-t.top,f=this._eventToPage(n,"X")-t.left,i=this.c.snapX,r;r=i===!0?t.offsetLeft:typeof i=="number"?t.offsetLeft+i:f+t.offsetLeft;this.dom.clone.css({top:u+t.offsetTop,left:r})},_emitEvent:function(t,i){this.s.dt.iterator("table",function(r){n(r.nTable).triggerHandler(t+".dt",i)})},_eventToPage:function(n,t){return n.type.indexOf("touch")!==-1?n.originalEvent.touches[0]["page"+t]:n["page"+t]},_mouseDown:function(r,u){var o=this,h=this.s.dt,e=this.s.start,s=u.offset(),f;e.top=this._eventToPage(r,"Y");e.left=this._eventToPage(r,"X");e.offsetTop=s.top;e.offsetLeft=s.left;e.nodes=n.unique(h.rows({page:"current"}).nodes().toArray());this._cachePositions();this._clone(u);this._clonePosition(r);this.dom.target=u;u.addClass("dt-rowReorder-moving");n(i).on("mouseup.rowReorder touchend.rowReorder",function(n){o._mouseUp(n)}).on("mousemove.rowReorder touchmove.rowReorder",function(n){o._mouseMove(n)});n(t).width()===n(i).width()&&n(i.body).addClass("dt-rowReorder-noOverflow");f=this.dom.dtScroll;this.s.scroll={windowHeight:n(t).height(),windowWidth:n(t).width(),dtTop:f.length?f.offset().top:null,dtLeft:f.length?f.offset().left:null,dtHeight:f.length?f.outerHeight():null,dtWidth:f.length?f.outerWidth():null}},_mouseMove:function(t){var r,o,f;this._clonePosition(t);var s=this._eventToPage(t,"Y")-this.s.bodyTop,u=this.s.middles,i=null,e=this.s.dt,h=e.table().body();for(r=0,o=u.length;r<o;r++)if(s<u[r]){i=r;break}i===null&&(i=u.length);(this.s.lastInsert===null||this.s.lastInsert!==i)&&(i===0?this.dom.target.prependTo(h):(f=n.unique(e.rows({page:"current"}).nodes().toArray()),i>this.s.lastInsert?this.dom.target.insertAfter(f[i-1]):this.dom.target.insertBefore(f[i])),this._cachePositions(),this.s.lastInsert=i);this._shiftScroll(t)},_mouseUp:function(){var b=this,r=this.s.dt,t,e,s=this.c.dataSrc,a,p,w;this.dom.clone.remove();this.dom.clone=null;this.dom.target.removeClass("dt-rowReorder-moving");n(i).off(".rowReorder");n(i.body).removeClass("dt-rowReorder-noOverflow");clearInterval(this.s.scrollInterval);this.s.scrollInterval=null;var o=this.s.start.nodes,u=n.unique(r.rows({page:"current"}).nodes().toArray()),h={},f=[],c=[],l=this.s.getDataFn,k=this.s.setDataFn;for(t=0,e=o.length;t<e;t++)if(o[t]!==u[t]){var v=r.row(u[t]).id(),d=r.row(u[t]).data(),y=r.row(o[t]).data();v&&(h[v]=l(y));f.push({node:u[t],oldData:l(d),newData:l(y),newPosition:t,oldPosition:n.inArray(u[t],o)});c.push(u[t])}if(a=[f,{dataSrc:s,nodes:c,values:h,triggerRow:r.row(this.dom.target)}],this._emitEvent("row-reorder",a),this.c.editor&&(this.c.enabled=!1,this.c.editor.edit(c,!1,n.extend({submit:"changed"},this.c.formOptions)).multiSet(s,h).one("submitComplete",function(){b.c.enabled=!0}).submit()),this.c.update){for(t=0,e=f.length;t<e;t++)p=r.row(f[t].node),w=p.data(),k(w,f[t].newData),r.columns().every(function(){this.dataSrc()===s&&r.cell(f[t].node,this.index()).invalidate("data")});this._emitEvent("row-reordered",a);r.draw(!1)}},_shiftScroll:function(n){var h=this,c=this.s.dt,t=this.s.scroll,o=!1,r=5,u=65,s=n.pageY-i.body.scrollTop,f,e;s<u?f=r*-1:s>t.windowHeight-u&&(f=r);t.dtTop!==null&&n.pageY<t.dtTop+u?e=r*-1:t.dtTop!==null&&n.pageY>t.dtTop+t.dtHeight-u&&(e=r);f||e?(t.windowVert=f,t.dtVert=e,o=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null);!this.s.scrollInterval&&o&&(this.s.scrollInterval=setInterval(function(){if(t.windowVert&&(i.body.scrollTop+=t.windowVert),t.dtVert){var n=h.dom.dtScroll[0];t.dtVert&&(n.scrollTop+=t.dtVert)}},20))}});u.defaults={dataSrc:0,editor:null,enabled:!0,formOptions:{},selector:"td:first-child",snapX:!1,update:!0};e=n.fn.dataTable.Api;e.register("rowReorder()",function(){return this});e.register("rowReorder.enable()",function(n){return n===r&&(n=!0),this.iterator("table",function(t){t.rowreorder&&(t.rowreorder.c.enabled=n)})});e.register("rowReorder.disable()",function(){return this.iterator("table",function(n){n.rowreorder&&(n.rowreorder.c.enabled=!1)})});u.version="1.2.0";n.fn.dataTable.RowReorder=u;n.fn.DataTable.RowReorder=u;n(i).on("init.dt.dtr",function(t,i){var r,e,o;t.namespace==="dt"&&(r=i.oInit.rowReorder,e=f.defaults.rowReorder,(r||e)&&(o=n.extend({},r,e),r!==!1&&new u(i,o)))});return u});
//# sourceMappingURL=dataTables.rowReorder.min.js.map

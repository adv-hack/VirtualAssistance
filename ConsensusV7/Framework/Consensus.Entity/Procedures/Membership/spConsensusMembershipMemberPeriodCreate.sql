if not exists (select object_id from sys.objects where type = 'P' and name = 'spConsensusMembershipMemberPeriodCreate')
  exec ('create procedure dbo.spConsensusMembershipMemberPeriodCreate as select 1 as temp')
go
alter procedure dbo.spConsensusMembershipMemberPeriodCreate(@PA_MEP_ID varchar(11) = null output, @PA_MEP_MEM_ID varchar(11) = null output, @PA_MEP_PROD_ID varchar(11) = null output, @PA_MEP_MEM_GRADE varchar(25) = null output, @PA_MEP_YEAR varchar(4) = null output, @PA_MEP_START datetime = null output, @PA_MEP_END datetime = null output, @PA_MEP_RENEW_DATE1 datetime = null output, @PA_MEP_RENEW_DATE2 datetime = null output, @PA_MEP_RENEW_DATE3 datetime = null output, @PA_MEP_QTY_1 integer = null output, @PA_MEP_QTY_2 integer = null output, @PA_MEP_QTY_3 integer = null output, @PA_MEP_QTY_4 integer = null output, @PA_MEP_QTY_5 integer = null output, @PA_MEP_FEE decimal(19, 4) = null output, @PA_MEP_FEE_BC decimal(19, 4) = null output, @PA_MEP_FEE_BC2 decimal(19, 4) = null output, @PA_MEP_CURRENCY varchar(3) = null output, @PA_MEP_FEE_EXTRA decimal(19, 4) = null output, @PA_MEP_FEE_EXTRA_BC decimal(19, 4) = null output, @PA_MEP_FEE_EXTRA_BC2 decimal(19, 4) = null output, @PA_MEP_PAY_METHOD varchar(40) = null output, @PA_MEP_PAY_STATUS varchar(40) = null output, @PA_MEP_PO_REF varchar(25) = null output, @PA_MEP_CCARD_TYPE varchar(40) = null output, @PA_MEP_NAME_ON_CARD varchar(80) = null output, @PA_MEP_CCARD_NUMBER varchar(50) = null output, @PA_MEP_CCARD_START varchar(5) = null output, @PA_MEP_CCARD_EXPY varchar(5) = null output, @PA_MEP_BANK_ACC_CODE varchar(20) = null output, @PA_MEP_SORT_CODE varchar(20) = null output, @PA_MEP_CCARD_ISSUE varchar(10) = null output, @PA_MEP_SECURITY varchar(10) = null output, @PA_MEP_CCARD_AUTHCODE varchar(30) = null output, @PA_MEP_DOCS_METHOD varchar(40) = null output, @PA_MEP_INV_ORG_ID varchar(11) = null output, @PA_MEP_INV_PROLE_ID varchar(11) = null output, @PA_MEP_INV_ADD_ID varchar(11) = null output, @PA_MEP_PRICE_LIST_ID varchar(11) = null output, @PA_MEP_CURRENT tinyint = null output, @PA_MEP_PM_ID varchar(11) = null output, @PA_MEP_SUB_ONLY integer = null output, @PA_MEP_RENEWED_DATE datetime = null output, @PA_MEP_LAPSED_DATE datetime = null output, @PA_MEP_RENEW_DATE_0 datetime = null output, @PA_MEP_STATUS varchar(50) = null output, @PA_MEP_SELCO_SP_ID varchar(11) = null output, @PA_MEP_RENEWAL_DATE datetime = null output, @PA_MEP_RENEW_START datetime = null output, @PA_MEP_CREATE_BAT_ID varchar(11) = null output, @PA_MEP_RENEW_BAT_ID varchar(11) = null output, @PA_MEP_OLD_MEP_ID varchar(11) = null output, @PA_MEP_INC_HIERARCHY integer = null output, @PA_MEP_NO_COPIES_1 integer = null output, @PA_MEP_NO_COPIES_2 integer = null output, @PA_MEP_NO_COPIES_3 integer = null output, @PA_MEP_CUST_ORDER_NO varchar(20) = null output, @PA_MEP_USERCHAR_1 varchar(100) = null output, @PA_MEP_CANCEL_REASON varchar(40) = null output, @PA_MEP_MEMB_RATE tinyint = null output, @PA_MEP_MEM_TYPE varchar(11) = null output, @PA_MEP_FOR_ATTN_OF nvarchar(410) = null output, @PA_MEP_ORG_CUST_AC varchar(50) = null output, @PA_MEP_REMIND1_BAT_ID varchar(11) = null output, @PA_MEP_REMIND2_BAT_ID varchar(11) = null output, @PA_MEP_REMIND3_BAT_ID varchar(11) = null output, @PA_MEP_REMIND4_BAT_ID varchar(11) = null output, @PA_MEP_REMIND1_DATE datetime = null output, @PA_MEP_REMIND2_DATE datetime = null output, @PA_MEP_REMIND3_DATE datetime = null output, @PA_MEP_REMIND4_DATE datetime = null output, @PA_MEP_PREV_STATUS varchar(40) = null output, @PA_MEP_CONT_PAYMENT tinyint = null output, @PA_MEP_NET_FEE decimal(19, 4) = null output, @PA_MEP_NET_FEE_BC decimal(19, 4) = null output, @PA_MEP_NET_FEE_BC2 decimal(19, 4) = null output, @PA_MEP_VAT_AMT decimal(19, 4) = null output, @PA_MEP_VAT_AMT_BC decimal(19, 4) = null output, @PA_MEP_VAT_AMT_BC2 decimal(19, 4) = null output, @PA_MEP_NOTES varchar(11) = null output, @PA_MEP_CURRENT_DATE datetime = null output, @PA_MEP_LAPSE_DATE datetime = null output, @PA_MEP_BATCH_INVOICE tinyint = null output, @PA_MEP_BASKET_FL tinyint = null output, @PA_MEP_INDEM_INSUR_DATE datetime = null output, @PA_MEP_EXP_BAT_ID varchar(11) = null output, @PA_MEP_ROLLBACK_DATE datetime = null output, @PA_MEP_STATUS_INT integer = null output, @PA_MEP_SHORT_DATED integer = null output, @PA_MEP_CART_ID integer = null output, @PA_MEP_PCLN_ID integer = null output, @PA_MEP_CURR_RATE_BC decimal(19, 8) = null output, @PA_MEP_CURR_RATE_BC2 decimal(19, 8) = null output, @PA_MEP_APP_METHOD varchar(40) = null output, @PA_MEP_OPP_ID varchar(11) = null output, @PA_MEP_DO_NOT_INVOIC tinyint = null output, @PA_MEP_PO_EXPIRATION_DATE datetime = null output, @PA_MEP_ACC_ID varchar(11) = null output, @PA_MEP_MEMBERSHIP_NAME varchar(40) = null output, @_AUDIT_USER_ID varchar(3) = null) as 
begin
  insert into dbo.Member_period(
    MEP_ADD_DATE,
    MEP_ADD_BY,
    MEP_MOD_DATE,
    MEP_MOD_BY,
    MEP_RCV_DATE,
    MEP_RCV_FROM,
    MEP_MEM_ID,
    MEP_PROD_ID,
    MEP_MEM_GRADE,
    MEP_YEAR,
    MEP_START,
    MEP_END,
    MEP_RENEW_DATE1,
    MEP_RENEW_DATE2,
    MEP_RENEW_DATE3,
    MEP_QTY_1,
    MEP_QTY_2,
    MEP_QTY_3,
    MEP_QTY_4,
    MEP_QTY_5,
    MEP_FEE,
    MEP_FEE_BC,
    MEP_FEE_BC2,
    MEP_CURRENCY,
    MEP_FEE_EXTRA,
    MEP_FEE_EXTRA_BC,
    MEP_FEE_EXTRA_BC2,
    MEP_PAY_METHOD,
    MEP_PAY_STATUS,
    MEP_PO_REF,
    MEP_CCARD_TYPE,
    MEP_NAME_ON_CARD,
    MEP_CCARD_NUMBER,
    MEP_CCARD_START,
    MEP_CCARD_EXPY,
    MEP_BANK_ACC_CODE,
    MEP_SORT_CODE,
    MEP_CCARD_ISSUE,
    MEP_SECURITY,
    MEP_CCARD_AUTHCODE,
    MEP_DOCS_METHOD,
    MEP_INV_ORG_ID,
    MEP_INV_PROLE_ID,
    MEP_INV_ADD_ID,
    MEP_PRICE_LIST_ID,
    MEP_CURRENT,
    MEP_PM_ID,
    MEP_SUB_ONLY,
    MEP_RENEWED_DATE,
    MEP_LAPSED_DATE,
    MEP_RENEW_DATE_0,
    MEP_STATUS,
    MEP_SELCO_SP_ID,
    MEP_RENEWAL_DATE,
    MEP_RENEW_START,
    MEP_CREATE_BAT_ID,
    MEP_RENEW_BAT_ID,
    MEP_OLD_MEP_ID,
    MEP_INC_HIERARCHY,
    MEP_NO_COPIES_1,
    MEP_NO_COPIES_2,
    MEP_NO_COPIES_3,
    MEP_CUST_ORDER_NO,
    MEP_USERCHAR_1,
    MEP_CANCEL_REASON,
    MEP_MEMB_RATE,
    MEP_MEM_TYPE,
    MEP_FOR_ATTN_OF,
    MEP_ORG_CUST_AC,
    MEP_REMIND1_BAT_ID,
    MEP_REMIND2_BAT_ID,
    MEP_REMIND3_BAT_ID,
    MEP_REMIND4_BAT_ID,
    MEP_REMIND1_DATE,
    MEP_REMIND2_DATE,
    MEP_REMIND3_DATE,
    MEP_REMIND4_DATE,
    MEP_PREV_STATUS,
    MEP_CONT_PAYMENT,
    MEP_NET_FEE,
    MEP_NET_FEE_BC,
    MEP_NET_FEE_BC2,
    MEP_VAT_AMT,
    MEP_VAT_AMT_BC,
    MEP_VAT_AMT_BC2,
    MEP_NOTES,
    MEP_CURRENT_DATE,
    MEP_LAPSE_DATE,
    MEP_BATCH_INVOICE,
    MEP_BASKET_FL,
    MEP_INDEM_INSUR_DATE,
    MEP_EXP_BAT_ID,
    MEP_ROLLBACK_DATE,
    MEP_STATUS_INT,
    MEP_SHORT_DATED,
    MEP_CART_ID,
    MEP_PCLN_ID,
    MEP_CURR_RATE_BC,
    MEP_CURR_RATE_BC2,
    MEP_APP_METHOD,
    MEP_OPP_ID,
    MEP_DO_NOT_INVOIC,
    MEP_PO_EXPIRATION_DATE,
    MEP_ACC_ID,
    MEP_MEMBERSHIP_NAME
  ) values (
    getDate(),
    @_AUDIT_USER_ID,
    getDate(),
    @_AUDIT_USER_ID,
    getDate(),
    '',
    @PA_MEP_MEM_ID,
    @PA_MEP_PROD_ID,
    @PA_MEP_MEM_GRADE,
    @PA_MEP_YEAR,
    @PA_MEP_START,
    @PA_MEP_END,
    @PA_MEP_RENEW_DATE1,
    @PA_MEP_RENEW_DATE2,
    @PA_MEP_RENEW_DATE3,
    @PA_MEP_QTY_1,
    @PA_MEP_QTY_2,
    @PA_MEP_QTY_3,
    @PA_MEP_QTY_4,
    @PA_MEP_QTY_5,
    @PA_MEP_FEE,
    @PA_MEP_FEE_BC,
    @PA_MEP_FEE_BC2,
    @PA_MEP_CURRENCY,
    @PA_MEP_FEE_EXTRA,
    @PA_MEP_FEE_EXTRA_BC,
    @PA_MEP_FEE_EXTRA_BC2,
    @PA_MEP_PAY_METHOD,
    @PA_MEP_PAY_STATUS,
    @PA_MEP_PO_REF,
    @PA_MEP_CCARD_TYPE,
    @PA_MEP_NAME_ON_CARD,
    @PA_MEP_CCARD_NUMBER,
    @PA_MEP_CCARD_START,
    @PA_MEP_CCARD_EXPY,
    @PA_MEP_BANK_ACC_CODE,
    @PA_MEP_SORT_CODE,
    @PA_MEP_CCARD_ISSUE,
    @PA_MEP_SECURITY,
    @PA_MEP_CCARD_AUTHCODE,
    @PA_MEP_DOCS_METHOD,
    @PA_MEP_INV_ORG_ID,
    @PA_MEP_INV_PROLE_ID,
    @PA_MEP_INV_ADD_ID,
    @PA_MEP_PRICE_LIST_ID,
    @PA_MEP_CURRENT,
    @PA_MEP_PM_ID,
    @PA_MEP_SUB_ONLY,
    @PA_MEP_RENEWED_DATE,
    @PA_MEP_LAPSED_DATE,
    @PA_MEP_RENEW_DATE_0,
    @PA_MEP_STATUS,
    @PA_MEP_SELCO_SP_ID,
    @PA_MEP_RENEWAL_DATE,
    @PA_MEP_RENEW_START,
    @PA_MEP_CREATE_BAT_ID,
    @PA_MEP_RENEW_BAT_ID,
    @PA_MEP_OLD_MEP_ID,
    @PA_MEP_INC_HIERARCHY,
    @PA_MEP_NO_COPIES_1,
    @PA_MEP_NO_COPIES_2,
    @PA_MEP_NO_COPIES_3,
    @PA_MEP_CUST_ORDER_NO,
    @PA_MEP_USERCHAR_1,
    @PA_MEP_CANCEL_REASON,
    @PA_MEP_MEMB_RATE,
    @PA_MEP_MEM_TYPE,
    @PA_MEP_FOR_ATTN_OF,
    @PA_MEP_ORG_CUST_AC,
    @PA_MEP_REMIND1_BAT_ID,
    @PA_MEP_REMIND2_BAT_ID,
    @PA_MEP_REMIND3_BAT_ID,
    @PA_MEP_REMIND4_BAT_ID,
    @PA_MEP_REMIND1_DATE,
    @PA_MEP_REMIND2_DATE,
    @PA_MEP_REMIND3_DATE,
    @PA_MEP_REMIND4_DATE,
    @PA_MEP_PREV_STATUS,
    @PA_MEP_CONT_PAYMENT,
    @PA_MEP_NET_FEE,
    @PA_MEP_NET_FEE_BC,
    @PA_MEP_NET_FEE_BC2,
    @PA_MEP_VAT_AMT,
    @PA_MEP_VAT_AMT_BC,
    @PA_MEP_VAT_AMT_BC2,
    @PA_MEP_NOTES,
    @PA_MEP_CURRENT_DATE,
    @PA_MEP_LAPSE_DATE,
    @PA_MEP_BATCH_INVOICE,
    @PA_MEP_BASKET_FL,
    @PA_MEP_INDEM_INSUR_DATE,
    @PA_MEP_EXP_BAT_ID,
    @PA_MEP_ROLLBACK_DATE,
    @PA_MEP_STATUS_INT,
    @PA_MEP_SHORT_DATED,
    @PA_MEP_CART_ID,
    @PA_MEP_PCLN_ID,
    @PA_MEP_CURR_RATE_BC,
    @PA_MEP_CURR_RATE_BC2,
    @PA_MEP_APP_METHOD,
    @PA_MEP_OPP_ID,
    @PA_MEP_DO_NOT_INVOIC,
    @PA_MEP_PO_EXPIRATION_DATE,
    @PA_MEP_ACC_ID,
    @PA_MEP_MEMBERSHIP_NAME
  );
    set @PA_MEP_ID = @@identity;
end
go
